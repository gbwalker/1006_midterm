---
title: "Midterm: Physiological Arousal and Political Beliefs"
output:
  pdf_document:
    md_extension: +raw_tex
# bibliography: citations.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(stringr)
library(bookdown)
library(mediation)
library(memisc)
library(extrafont)

# Replication of "Physiological Arousal and Political Beliefs"
# Published in Political Psychology (2014)
# Original authors: Jonathan Renshon, Julia Lee & Dustin Tingley
```

\begin{flushright}
Gabe Walker

March 16, 2019
\end{flushright}

```{r data, echo=FALSE, message=FALSE, error=FALSE}

# Read in the replication file provided on the Harvard Dataverse.
# https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/24318

df <- read_csv("replication_files/anxiety.csv") %>% 
  
# Remove the two observations who have a lot of missing data.
  
  filter(! {is.na(income) & is.na(education)}) %>% 

# Rename and restructure variables for ease of understanding.
# "video" refers to which video the subject was shown.

  mutate(video = factor(case_when(
    anxcond3 == 0 ~ "relax",
    anxcond3 == 1 ~ "neutral",
    anxcond3 == 2 ~ "anxiety"
  ))) %>% 
  
  dplyr::select(-anxcond3) %>% 

# "anxiety" is a dummy for whether the subject was shown the Cliffhanger clip.
    
  mutate(anxiety = factor(anxcond)) %>% 
  dplyr::select(-anxcond) %>% 

# "skin" is the standardized skin-conductance level within each participant.
# See the original paper (p. 7) for a detailed description of standardization.

  mutate(skin = SCDBradSelfReport1_mean) %>% 
  dplyr::select(-SCDBradSelfReport1_mean) %>% 

# "story" is a random dummy for which immigration article the participants read.
  
  mutate(story = factor(storycond)) %>% 
  dplyr::select(-storycond)

```



### Abstract

### Table 1

```{r echo=FALSE, message=FALSE, error=FALSE, cache=TRUE}
### Figure 2.

# Make three data subsets for each treatment group.
# Remove the NA values so that certain functions (e.g., mean()) work.

relax <- df %>%
  filter(video == "relax") %>%
  na.omit()

neutral <- df %>%
  filter(video == "neutral") %>%
  na.omit()

anxiety <- df %>%
  filter(video == "anxiety") %>%
  na.omit()

# Make a plottable dataframe with the means,
# confidence intervals, and counts for the "skin"
# variable for each group

# Find the means of each group.

means <- c(mean(relax$skin), mean(neutral$skin), mean(anxiety$skin))

# Find the confidence interval sizes for each group.

ci_relax <- 1.96 * sd(relax$skin) / sqrt(length(relax$skin))
ci_neutral <- 1.96 * sd(neutral$skin) / sqrt(length(neutral$skin))
ci_anxiety <- 1.96 * sd(anxiety$skin) / sqrt(length(anxiety$skin))

# Find the upper and lower bounds for each group.

lower <- c(means[1] - ci_relax, means[2] - ci_neutral, means[3] - ci_anxiety)
upper <- c(means[1] + ci_relax, means[2] + ci_neutral, means[3] + ci_anxiety)

# Put the results in a graphable dataframe.

f2 <- tibble(
  treatment = c("Relax", "Neutral", "Anxiety"),
  mean = means,
  lower = lower,
  upper = upper,
  count = c(nrow(relax), nrow(neutral), nrow(anxiety)),
  x = c(1,2,3)
)

# Plot the result.

ggplot(f2, aes(x, mean, group = treatment, col = treatment)) +
  geom_segment(aes(x = x, y = lower, xend = x, yend = upper), size = .75) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  geom_point(size = 2.5, col = "white") +
  geom_point(aes(col = treatment), size = 1.5) +
  labs(y = "Skin Conductance Reactivity",
       title = "The anxiety treatment significantly increased skin conductance reactivity") +
  scale_color_discrete(name = "Treatment") +
  theme(text=element_text(family = "LM Roman 10"),
        panel.background = element_blank(),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        legend.key = element_blank())
```

**Figure 2.** Means of skin-conductance reactivity by video condition. 95% confidence intervals shown.

```{r echo=FALSE, message=FALSE, error=FALSE, cache=TRUE}
### Figure 3.

# Subset the data to only include individuals in the
# "neutral" or "anxiety" video treatment groups.

no_relax <- df %>% 
  filter(video != "relax")

## Outcome model
# Regress the immigration score on the anxiety dummy, controling for skin (SCL) score
# and story group.

mod_outcome <- lm(immigration ~ anxiety + skin + story, no_relax)

## Mediator Model
# Regress the skin (SCL) score on the anxiety dummy while controling for story group.
# Note that this includes the "story" variable, which is not in the main results.

mod_mediator <- lm(skin ~ anxiety + story, no_relax)

## Mediation Analysis

x <- mediate(mod_mediator, 
                     mod_outcome, 
                     sims = 500, 
                     treat = "anxiety", 
                     mediator = "skin", 
                     dropobs = TRUE, 
                     boot = TRUE, 
                     conf.level = .90)

# Save the results to a plottable dataframe.

f3 <- tibble(
  effect = c("ACME", "Direct Effect", "Total Effect"),
  estimate = c(x$d.avg, x$z.avg, x$tau.coef),
  lower = c(x$d.avg.ci[[1]], x$z.avg.ci[[1]], x$tau.ci[[1]]),
  upper = c(x$d.avg.ci[[2]], x$z.avg.ci[[2]], x$tau.ci[[2]]),
  pval = c(x$d.avg.p, x$z.avg.p, x$tau.p),
  y = c(1,2,3)
)

# Plot the result.

ggplot(f3, aes(estimate, y, group = effect, col = effect)) +
  geom_segment(aes(x = lower, y = y, xend = upper, yend = y), size = .75) +
  geom_vline(xintercept = 0, linetype = "dashed") +
  geom_point(aes(estimate), size = 2.5, col = "white") +
  geom_point(aes(estimate, col = effect), size = 1.5) +
  labs(x = "Causal mediation effect",
       title = "The indirect effect of physiological reactivity (ACME) is positive and significant") +
  scale_color_discrete(name = "Effect") +
  theme(text=element_text(family = "LM Roman 10"),
        panel.background = element_blank(),
        axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        legend.key = element_blank())
```

**Figure 3.** *Treatment* is anxiety video manipulation (compared to neutral condition), *Mediator* is skin conductance reactivity when answering immigration questions, *Outcome* is composite variable of immigration preferences. Horizontal lines represent 90% confidence intervals for estimates. (p. 11)

### Extension


### References
